import{d as C,e as S,r,u as j,f as B,c as g,o as h,a as e,k as I,t as i,b as d,i as N}from"./app-DttZW8gq.js";import{_ as Q}from"./MainLayout.vue_vue_type_script_setup_true_lang-CFcmkc8A.js";const R={class:"container mx-auto p-6"},T={class:"text-xl font-bold mb-4"},D={key:0,class:"mb-4"},E=["disabled"],F=["disabled"],V={layout:Q},$=C({...V,__name:"Create",setup(q){const v=S(),m=v.props.jobTitle,n=v.props.questions,c=r(null);let a,u=[],t=null;const l=r(!1),o=r(0),p=r([]),f=j({recordings:[],job_title:m,questions:n}),_=B(()=>o.value===n.length-1);async function w(){t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),c.value&&(c.value.srcObject=t),u=[],a=new MediaRecorder(t),a.ondataavailable=s=>u.push(s.data),a.start(),l.value=!0}function y(){t&&(t.getTracks().forEach(s=>s.stop()),t=null)}function k(){a.stop(),a.onstop=()=>{const s=new Blob(u,{type:"video/webm"}),b=new File([s],`answer_${o.value+1}.webm`,{type:"video/webm"});p.value.push(b),y(),_.value?(f.recordings=p.value,f.post(route("interview.store"),{forceFormData:!0,onError:x=>console.error("Upload failed:",x),onSuccess:()=>console.log("Interview submitted successfully!")})):(o.value++,l.value=!1)}}return(s,b)=>(h(),g("div",R,[e("h2",T,"Interview: "+i(d(m)),1),o.value<d(n).length?(h(),g("div",D,[e("p",null,[e("strong",null,"Q"+i(o.value+1)+":",1),N(" "+i(d(n)[o.value]),1)])])):I("",!0),e("video",{ref_key:"video",ref:c,autoplay:"",playsinline:"",class:"border rounded w-full h-64 mb-4"},null,512),e("div",null,[e("button",{onClick:w,disabled:l.value,class:"btn mr-2"},"Start Recording",8,E),e("button",{onClick:k,disabled:!l.value,class:"btn"},i(_.value?"Submit Interview":"Next Question"),9,F)])]))}});export{$ as default};
